using System.Diagnostics.CodeAnalysis;
using System.Globalization;
using System.Xml;
using ForcesOfCorruptionModdingTool.AlomoEngine.Core;
using ForcesOfCorruptionModdingTool.AlomoEngine.Interfaces;
using ForcesOfCorruptionModdingTool.AlomoEngine.XmlEngine;

namespace ForcesOfCorruptionModdingTool.AlomoEngine.EngineObjects.GameConstants
{
    [SuppressMessage("ReSharper", "InconsistentNaming")]
    public class ShipLoadVulnerabilityData : EngineObject
    {
        public ShipLoadVulnerabilityData(IGameXmlFile parent) : base(parent) {}

        public double Elevated_Vulnerability_Duration { get; set; }

        public double Elevated_Vulnerability_Factor { get; set; }

        public double Space_Elevated_Vulnerability_Duration { get; set; }

        public double Space_Elevated_Vulnerability_Factor { get; set; }

        public override XmlElement Serialize()
        {
            var node = Parent.RootNode;
            node.SetValueOfLastTagOfName(nameof(Elevated_Vulnerability_Duration),
                Elevated_Vulnerability_Duration.ToString(CultureInfo.InvariantCulture));
            node.SetValueOfLastTagOfName(nameof(Elevated_Vulnerability_Factor),
                Elevated_Vulnerability_Factor.ToString(CultureInfo.InvariantCulture));
            node.SetValueOfLastTagOfName(nameof(Space_Elevated_Vulnerability_Duration),
                Space_Elevated_Vulnerability_Duration.ToString(CultureInfo.InvariantCulture));
            node.SetValueOfLastTagOfName(nameof(Space_Elevated_Vulnerability_Factor),
                Space_Elevated_Vulnerability_Factor.ToString(CultureInfo.InvariantCulture));
            return node;
        }

        public override void Deserialize(XmlElement node)
        {
            Description = node.GetCommentsOverElements(nameof(Elevated_Vulnerability_Duration),
                nameof(Space_Elevated_Vulnerability_Factor));

            Elevated_Vulnerability_Duration =
                node.GetValueOfLastTagOfName(nameof(Elevated_Vulnerability_Duration)).ToEngineFloat();
            Elevated_Vulnerability_Factor =
                node.GetValueOfLastTagOfName(nameof(Elevated_Vulnerability_Factor)).ToEngineFloat();
            Space_Elevated_Vulnerability_Duration =
                node.GetValueOfLastTagOfName(nameof(Space_Elevated_Vulnerability_Duration)).ToEngineFloat();
            Space_Elevated_Vulnerability_Factor =
                node.GetValueOfLastTagOfName(nameof(Space_Elevated_Vulnerability_Factor)).ToEngineFloat();
        }
    }
}
